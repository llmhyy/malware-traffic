import xml.etree.ElementTree as ET
from python_ping import tcp_ping
import glob

xml_files = [f for f in glob.glob("decrypted/*.xml")]

for xml in xml_files:
    print("-----------------------")
    print(xml)
    tree = ET.parse(xml)
    root = tree.getroot()
    for serv in root[2]:
        socket = serv.text
        ip, port = socket.split(":")
        passed = tcp_ping(ip, port)
        if passed > 0:
            print(f"ONLINE  {ip}:{port}  [{passed}]")
        