# Experiment 10

## Goals

The goal was to extend our analysis to other stages of the trickbot malware, and to run it multiple times to see if our results are consistent.

## Procedure

Same as before, recording with Wireshark + custom python scripts to link processes to socket connections.

## Analysis

Our recording was interesting. The first time I ran the malware, it updated its config file. This time, it did not.

Also, I was able to observe the "pwgrab" module in the pcap recording. As it is a password grabber, I put a fake password in my Chrome browser.

<img src="./doc/chrome_pass.png" width="800">

We can see the password is `AZERTY12345`.

The corresponding network frame is the following :

<img src="./doc/clear_pass.png" width="800">

Let's observe it in Wireshark.

<img src="./doc/send_global.png" width="800">

It's sent in clear through HTTP, but on an unusual port (8280). Let's observe the content.

<img src="./doc/send_detail.png" width="800">

We can see our email and password in clear, the PwGraber was able to recover and send it. If we take a bird eye view, here is the complete segmentation :

<img src="./doc/segmentation.png" width="800">

Here is my interpretation with an UML sequence diagram.

<img src="./doc/seq_diag.png" width="800">