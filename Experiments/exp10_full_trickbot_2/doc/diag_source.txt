title Trickbot all stages (https://sequencediagram.org/)


participant Trickbot
participant External Ip Provider
participant C&C1
participant C&C2
participant C&C3
participant C&C4 (pwgrab source)
participant C&C6
participant C&C5
participant C&C7
participant C&C8

Trickbot->External Ip Provider:Get IP Address
note over Trickbot,External Ip Provider:If the request is in HTTP, it may be redirected to HTTPS
External Ip Provider->Trickbot:IP address of the infected computer

Trickbot->C&C1:Connection attempt (4 SYN packets)
Trickbot->C&C2:Connection attempt (4 SYN packets)
Trickbot->C&C3:Connection
C&C3->Trickbot:Receive info from C2 (updated C2 lists, server to download modules)
note over Trickbot,C&C3:From here, new C&C servers are added

Trickbot->C&C4 (pwgrab source):Connection
C&C4 (pwgrab source)->Trickbot:Download of **Pwgrab** module
note over Trickbot,C&C4 (pwgrab source):Pwgrab runs and gets the password of the different browsers
Trickbot->C&C6:Connection attempt (4 SYN packets)
Trickbot->C&C5:Send exfiltrated password data
Trickbot->C&C7:Connection attempt (4 SYN packets)
Trickbot->C&C8:Connection attempt (4 SYN packets)

