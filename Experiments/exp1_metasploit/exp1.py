from scapy.all import *
import matplotlib.pyplot as plt
import numpy as np

times_src, times_dst = [], []

packets = rdpcap('cap2.pcapng')
for packet in packets:
    if TCP in packet and packet[IP].src=="10.0.2.5":
        times_src.append(packet.time*1000000)
    elif TCP in packet and packet[IP].dst=="10.0.2.5":
        times_dst.append(packet.time*1000000)   

min_time = packets[0].time*1000000
times_src = list(map(lambda x: (x - min_time), times_src))
times_dst = list(map(lambda x: (x - min_time), times_dst))

times = [times_src, times_dst]
colors = ['red', 'lime']
description = ['received', "emitted"]
plt.hist(times, bins=19, histtype='bar', color=colors, label=description)
plt.legend(loc="upper right")
plt.title('Nb of packets')

plt.show()