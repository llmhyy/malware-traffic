from correlation import *
import seaborn as sns
import matplotlib.pyplot as plt
import pandas as pd

paths = ["trickbot1_1/", "trickbot1_2/", "trickbot1_3/", "trickbot1_5/"]
fig, axes = plt.subplots(len(paths), 1, figsize=(15, 10))
for o in range(len(paths)):
	path = paths[o]
	segmentations1, cluster_indexes1, nb_class1, call_dict_1, call_dict2_1 = get_malware_segmentation_cluster_sequence(
		path, "malware.exe")
	c1 = call_dict_1[0][:, 1]
	c1 = [str.replace(a, "\n", "") for a in c1]
	sns.countplot(c1, order=pd.value_counts(c1).iloc[:20].index, ax=axes[o])
	axes[o].tick_params(axis="x", rotation=55)
fig.tight_layout()
plt.plot()
