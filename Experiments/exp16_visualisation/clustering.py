import numpy as np
from fastdtw import fastdtw
from matplotlib import pyplot as plt
import scipy
import scipy.cluster as cluster
from sklearn.cluster import KMeans
import string 

# TODO: link to where I picked some code (Spectral + hierarchical)
# TODO: documentation

DEBUG = True
test = [[['HANDSHAKE_FAILED', [0, 4], [0, 15231939]]],[['HANDSHAKE_FAILED', [0, 1], [0, 60394]], ['HANDSHAKE_FAILED', [2, 3], [729502, 794342]], ['HANDSHAKE_FAILED', [4, 5], [1339530, 1399037]], ['HANDSHAKE_FAILED', [6, 7], [1934468, 1995390]], ['HANDSHAKE_FAILED', [8, 9], [2637369, 2704080]]],[['HANDSHAKE_FAILED', [0, 1], [0, 60031]], ['HANDSHAKE_FAILED', [2, 3], [696739, 756691]], ['HANDSHAKE_FAILED', [4, 5], [1291883, 1351686]], ['HANDSHAKE_FAILED', [6, 7], [1994016, 2060749]], ['HANDSHAKE_FAILED', [8, 9], [2696113, 2757354]]],[['HANDSHAKE_FAILED', [0, 1], [0, 64866]], ['HANDSHAKE_FAILED', [2, 3], [656480, 717454]], ['HANDSHAKE_FAILED', [4, 5], [1359732, 1424722]], ['HANDSHAKE_FAILED', [6, 7], [1968324, 2028036]], ['HANDSHAKE_FAILED', [8, 9], [2561709, 2623345]]],[['HANDSHAKE', [0, 2], [0, 40419]], ['OUT', [3, 7], [484128, 5280772], 5], ['TERM_RST', [8, 8], [10093551, 10093551]]],[['HANDSHAKE_FAILED', [0, 4], [0, 15155880]]],[['HANDSHAKE_FAILED', [0, 4], [0, 15305755]]],[['HANDSHAKE_FAILED', [0, 1], [0, 79383]], ['HANDSHAKE_FAILED', [2, 3], [686827, 766790]], ['HANDSHAKE_FAILED', [4, 5], [1280529, 1364693]], ['HANDSHAKE_FAILED', [6, 7], [1874047, 1954121]], ['HANDSHAKE_FAILED', [8, 9], [2484436, 2566970]]],[['HANDSHAKE_FAILED', [0, 1], [0, 81558]], ['HANDSHAKE_FAILED', [2, 3], [623612, 702263]], ['HANDSHAKE_FAILED', [4, 5], [1248384, 1327683]], ['HANDSHAKE_FAILED', [6, 7], [1857422, 1936129]], ['HANDSHAKE_FAILED', [8, 9], [2532239, 2612937]]],[['HANDSHAKE_FAILED', [0, 1], [0, 78533]], ['HANDSHAKE_FAILED', [2, 3], [578634, 663336]], ['HANDSHAKE_FAILED', [4, 5], [1186944, 1266266]], ['HANDSHAKE_FAILED', [6, 7], [1876169, 1955727]], ['HANDSHAKE_FAILED', [8, 9], [2578499, 2657930]]],[['HANDSHAKE', [0, 2], [0, 220643]], ['TLS_handshake', [3, 7], [231728, 700898]], ['OUT_TLS', [8, 9], [717864, 968840], 234], ['IN_TLS', [10, 11], [1053164, 1137646], 421], ['OUT_TLS', [12, 13], [1483649, 1734655], 346], ['IN_TLS', [14, 14], [1905980, 1905980], 677], ['OUT_TLS', [15, 16], [1978544, 2194946], 234], ['IN_TLS', [17, 17], [2330339, 2330339], 165], ['OUT_TLS', [18, 19], [2371634, 2592910], 330], ['IN_TLS', [20, 20], [2713889, 2713889], 165], ['OUT_TLS', [21, 22], [2831155, 3073032], 266], ['IN_TLS', [23, 24], [3209113, 3345205], 165], ['OUT_TLS', [25, 26], [7728430, 7924846], 234], ['IN_TLS', [27, 28], [8053811, 8221074], 1253], ['OUT_TLS', [29, 30], [8315771, 8512246], 250], ['IN_TLS', [31, 31], [8639830, 8639830], 165], ['OUT_TLS', [32, 33], [8677065, 8904059], 234], ['IN_TLS', [34, 35], [9032445, 9236919], 981], ['OUT_TLS', [36, 39], [10252337, 10474063], 532], ['IN_TLS', [40, 41], [10616692, 10721281], 181], ['OUT_TLS', [42, 43], [10767813, 11010637], 234], ['IN_TLS', [44, 45], [11142923, 11330461], 165], ['OUT_TLS', [46, 47], [11987901, 12212429], 250], ['IN_TLS', [48, 49], [12344578, 12533832], 165], ['OUT_TLS', [50, 53], [12564788, 12779344], 596], ['IN_TLS', [54, 55], [12919992, 13033943], 181], ['OUT_TLS', [56, 59], [46028217, 46326237], 532], ['IN_TLS', [60, 61], [46457037, 46533865], 181], ['OUT_TLS', [62, 65], [50561789, 50832504], 564], ['IN_TLS', [66, 67], [50965468, 51020254], 181], ['OUT_TLS', [68, 71], [55116059, 55369841], 564], ['IN_TLS', [72, 73], [55520006, 55631520], 181], ['OUT_TLS', [74, 77], [59662261, 59893310], 532], ['IN_TLS', [78, 79], [60051575, 60130323], 181], ['OUT_TLS', [80, 83], [64067824, 64329416], 564], ['IN_TLS', [84, 85], [64468361, 64630622], 181], ['OUT_TLS', [86, 89], [68466517, 68760993], 564], ['IN_TLS', [90, 91], [68908124, 69131453], 181], ['OUT_TLS', [92, 95], [72925989, 73198598], 548], ['IN_TLS', [96, 98], [73330403, 138322338], 218], ['IN', [99, 100], [138323256, 138323308], 0], ['OUT_TLS', [101, 101], [138337977, 138337977], 37], ['OUT', [102, 102], [138338187, 138338187], 0], ['TERM_RST', [103, 103], [138584948, 138584948]], ['TERM_RST', [104, 104], [138585218, 138585218]]],[['HANDSHAKE', [0, 2], [0, 9452]], ['OUT', [3, 4], [9584, 18973], 86], ['IN', [5, 6], [131987, 327408], 410], ['OUT', [7, 7], [169029681, 169029681], 0]],[['HANDSHAKE', [0, 2], [0, 17785]], ['TLS_handshake', [3, 7], [46837, 114318]], ['OUT', [8, 9], [115282, 168666], 197], ['IN', [10, 55], [736644, 849372], 51806], ['OUT', [56, 56], [849485, 849485], 12], ['OUT', [57, 57], [849633, 849633], 12], ['OUT', [58, 58], [849826, 849826], 0], ['OUT', [59, 59], [850030, 850030], 0], ['IN', [60, 1180], [850965, 67417520], 1193680], ['IN', [1181, 1182], [67417665, 67417685], 0], ['OUT', [1183, 1183], [67421868, 67421868], 31], ['OUT', [1184, 1184], [67421910, 67421910], 0], ['TERM_RST', [1185, 1185], [67439090, 67439090]], ['TERM_RST', [1186, 1186], [67439635, 67439635]]],[['HANDSHAKE', [0, 2], [0, 198737]], ['TLS_handshake', [3, 5], [253502, 452406]], ['OUT_TLS', [6, 10], [470731, 730819], 607], ['IN_TLS', [11, 12], [832323, 1063843], 181], ['OUT_TLS', [13, 14], [1662819, 1953026], 234], ['IN_TLS', [15, 16], [2080470, 2268118], 421], ['OUT_TLS', [17, 18], [2282871, 2507991], 346], ['IN_TLS', [19, 20], [2663216, 2751452], 677], ['OUT_TLS', [21, 22], [3243916, 3500703], 330], ['IN_TLS', [23, 24], [3629755, 3861026], 165], ['OUT_TLS', [25, 26], [4501087, 4726187], 250], ['IN_TLS', [27, 28], [4853429, 5064003], 181], ['OUT_TLS', [29, 32], [35891283, 36180225], 548], ['IN_TLS', [33, 34], [36319609, 36376940], 181], ['OUT_TLS', [35, 38], [40455796, 40732298], 532], ['IN_TLS', [39, 40], [40873383, 40957261], 181], ['OUT_TLS', [41, 44], [44894828, 45186219], 564], ['IN_TLS', [45, 46], [45340718, 45457395], 181], ['OUT_TLS', [47, 50], [49425469, 49662055], 548], ['IN_TLS', [51, 52], [49826397, 49972828], 181], ['OUT_TLS', [53, 56], [53863734, 54088472], 532], ['IN_TLS', [57, 58], [54224354, 54269907], 181], ['OUT_TLS', [59, 62], [58266596, 58497184], 564], ['IN_TLS', [63, 64], [58646523, 58864243], 181], ['OUT_TLS', [65, 68], [62768063, 63032842], 532], ['IN_TLS', [69, 70], [63162346, 63269956], 181], ['OUT_TLS', [71, 74], [67363970, 67645803], 548], ['IN_TLS', [75, 77], [67788281, 132777008], 218], ['IN', [78, 79], [132777636, 132777667], 0], ['OUT_TLS', [80, 80], [132777891, 132777891], 37], ['OUT', [81, 81], [132777934, 132777934], 0], ['TERM_RST', [82, 82], [133061309, 133061309]], ['TERM_RST', [83, 83], [133061309, 133061309]]],[['HANDSHAKE', [0, 2], [0, 451965]], ['OUT', [3, 6], [462201, 915844], 656], ['IN', [7, 8], [921690, 921730], 139], ['TERM', [9, 12], [921979, 1385107]]],[['HANDSHAKE', [0, 2], [0, 226632]], ['TLS_handshake', [3, 5], [235741, 474816]], ['OUT_TLS', [6, 8], [512540, 749317], 309], ['IN_TLS', [9, 11], [866138, 65874387], 218], ['IN', [12, 13], [65874387, 65874449], 0], ['OUT_TLS', [14, 14], [65889785, 65889785], 37], ['OUT', [15, 15], [65889860, 65889860], 0], ['TERM_RST', [16, 16], [66111585, 66111585]], ['TERM_RST', [17, 17], [66111585, 66111585]]],[['HANDSHAKE', [0, 2], [0, 254285]], ['TLS_handshake', [3, 7], [277784, 836787]], ['OUT_TLS', [8, 9], [839821, 1156647], 250], ['IN_TLS', [10, 12], [1259955, 66208730], 218], ['OUT_TLS', [13, 13], [66208880, 66208880], 37], ['OUT', [14, 14], [66208971, 66208971], 0], ['IN', [15, 15], [66208997, 66208997], 0], ['OUT', [16, 16], [66209022, 66209022], 0], ['TERM_RST', [17, 17], [66406089, 66406089]]],[['HANDSHAKE', [0, 2], [0, 261056]], ['TLS_handshake', [3, 5], [264767, 499372]], ['OUT_TLS', [6, 8], [500108, 727623], 309], ['IN_TLS', [9, 11], [861811, 65836982], 218], ['IN', [12, 13], [65837636, 65837657], 0], ['OUT_TLS', [14, 14], [65846565, 65846565], 37], ['OUT', [15, 15], [65846616, 65846616], 0], ['TERM_RST', [16, 16], [66053550, 66053550]], ['TERM_RST', [17, 17], [66053550, 66053550]]],[['HANDSHAKE', [0, 2], [0, 269863]], ['TLS_handshake', [3, 7], [278009, 850918]], ['OUT_TLS', [8, 9], [890992, 1176261], 250], ['IN_TLS', [10, 12], [1263174, 66272547], 218], ['IN', [13, 14], [66272801, 66272821], 0], ['OUT_TLS', [15, 15], [66296235, 66296235], 37], ['OUT', [16, 16], [66296486, 66296486], 0], ['TERM_RST', [17, 17], [66524358, 66524358]], ['TERM_RST', [18, 18], [66524358, 66524358]]],[['HANDSHAKE', [0, 2], [0, 195267]], ['TLS_handshake', [3, 5], [196421, 396962]], ['OUT_TLS', [6, 8], [414907, 607561], 309]]]
test2 = [[['HANDSHAKE_FAILED', [0, 4], [0, 15034292]]], [['HANDSHAKE_FAILED', [0, 1], [0, 172621]], ['HANDSHAKE_FAILED', [2, 3], [673738, 855828]], ['HANDSHAKE_FAILED', [4, 5], [1361867, 1535434]], ['HANDSHAKE_FAILED', [6, 7], [2042433, 2215971]], ['HANDSHAKE_FAILED', [8, 9], [2792513, 2965079]]], [['HANDSHAKE_FAILED', [0, 1], [0, 171464]], ['HANDSHAKE_FAILED', [2, 3], [695445, 868060]], ['HANDSHAKE_FAILED', [4, 5], [1395043, 1567550]], ['HANDSHAKE_FAILED', [6, 7], [2192053, 2368442]], ['HANDSHAKE_FAILED', [8, 9], [2895237, 3068603]]], [['HANDSHAKE_FAILED', [0, 1], [0, 172872]], ['HANDSHAKE_FAILED', [2, 3], [688440, 860414]], ['HANDSHAKE_FAILED', [4, 5], [1391575, 1564715]], ['HANDSHAKE_FAILED', [6, 7], [2201789, 2431553]], ['HANDSHAKE_FAILED', [8, 9], [3001617, 3174705]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15337285]]], [['HANDSHAKE', [0, 2], [0, 40109]], ['OUT', [3, 7], [452083, 5140335], 5], ['TERM_RST', [8, 8], [9945627, 9945627]]], [['HANDSHAKE_FAILED', [0, 1], [0, 62168]], ['HANDSHAKE_FAILED', [2, 3], [732363, 805034]], ['HANDSHAKE_FAILED', [4, 5], [1318405, 1379655]], ['HANDSHAKE_FAILED', [6, 7], [1945607, 2012067]], ['HANDSHAKE_FAILED', [8, 9], [2536999, 2598085]]], [['HANDSHAKE_FAILED', [0, 1], [0, 58656]], ['HANDSHAKE_FAILED', [2, 3], [583046, 643511]], ['HANDSHAKE_FAILED', [4, 5], [1208264, 1267490]], ['HANDSHAKE_FAILED', [6, 7], [1796866, 1856145]], ['HANDSHAKE_FAILED', [8, 9], [2484004, 2545684]]], [['HANDSHAKE_FAILED', [0, 1], [0, 58845]], ['HANDSHAKE_FAILED', [2, 3], [564114, 630546]], ['HANDSHAKE_FAILED', [4, 5], [1141837, 1202203]], ['HANDSHAKE_FAILED', [6, 7], [1706410, 1767478]], ['HANDSHAKE_FAILED', [8, 9], [2277481, 2343225]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15269801]]], [['HANDSHAKE_FAILED', [0, 1], [0, 205784]], ['HANDSHAKE_FAILED', [2, 3], [812466, 1017611]], ['HANDSHAKE_FAILED', [4, 5], [1702841, 1907110]], ['HANDSHAKE_FAILED', [6, 7], [2421105, 2623347]], ['HANDSHAKE_FAILED', [8, 9], [3202257, 3410586]]], [['HANDSHAKE_FAILED', [0, 1], [0, 206640]], ['HANDSHAKE_FAILED', [2, 3], [834168, 1042024]], ['HANDSHAKE_FAILED', [4, 5], [1648575, 1855782]], ['HANDSHAKE_FAILED', [6, 7], [2442274, 2649328]], ['HANDSHAKE_FAILED', [8, 9], [3333181, 3539290]]], [['HANDSHAKE_FAILED', [0, 1], [0, 201993]], ['HANDSHAKE_FAILED', [2, 3], [873320, 1090177]], ['HANDSHAKE_FAILED', [4, 5], [1669892, 1872421]], ['HANDSHAKE_FAILED', [6, 7], [2373277, 2576716]], ['HANDSHAKE_FAILED', [8, 9], [3170214, 3378102]]], [['HANDSHAKE', [0, 2], [0, 181518]], ['TLS_handshake', [3, 7], [182037, 585747]], ['OUT_TLS', [8, 9], [613842, 836933], 234], ['IN_TLS', [10, 11], [922507, 1063131], 421], ['OUT_TLS', [12, 13], [1376324, 1559687], 346], ['IN_TLS', [14, 14], [1784087, 1784087], 741], ['OUT_TLS', [15, 16], [1838482, 2019478], 234], ['IN_TLS', [17, 17], [2154282, 2154282], 165], ['OUT_TLS', [18, 19], [2155506, 2336519], 330], ['IN_TLS', [20, 20], [2621715, 2621715], 165], ['OUT_TLS', [21, 22], [2625845, 2813079], 266], ['IN_TLS', [23, 25], [2943149, 67943646], 202], ['IN', [26, 27], [67943646, 67943715], 0], ['OUT_TLS', [28, 28], [67943818, 67943818], 37], ['OUT', [29, 29], [67943869, 67943869], 0], ['TERM_RST', [30, 30], [68124832, 68124832]], ['TERM_RST', [31, 31], [68124832, 68124832]]], [['HANDSHAKE', [0, 2], [0, 85511]], ['TLS_handshake', [3, 11], [85872, 178414]], ['IN_TLS', [12, 12], [263642, 263642], 51], ['OUT_TLS', [13, 13], [266881, 266881], 129], ['IN_TLS', [14, 16], [381437, 59938811], 244], ['OUT_TLS', [17, 17], [59939051, 59939051], 31], ['OUT', [18, 18], [59939120, 59939120], 0], ['IN', [19, 19], [59939609, 59939609], 0]], [['HANDSHAKE_FAILED', [0, 4], [0, 15365256]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15062320]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15045039]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15038350]]], [['HANDSHAKE', [0, 2], [0, 23735]], ['TLS_handshake', [3, 7], [24283, 74694]], ['OUT', [8, 9], [78195, 138673], 198], ['IN', [10, 283], [899536, 1363745], 283802], ['OUT', [284, 284], [1363784, 1363784], 12], ['IN', [285, 286], [1364171, 1364171], 2920], ['OUT', [287, 288], [1364192, 1364223], 48], ['IN', [289, 289], [1364346, 1364346], 1460], ['OUT', [290, 290], [1364398, 1364398], 36], ['IN', [291, 292], [1364760, 1364760], 2920], ['OUT', [293, 294], [1364788, 1364830], 72], ['IN', [295, 295], [1381422, 1381422], 257], ['OUT', [296, 296], [1381461, 1381461], 36], ['IN', [297, 297], [1386402, 1386402], 1460], ['OUT', [298, 298], [1386444, 1386444], 36], ['IN', [299, 299], [1386636, 1386636], 1460], ['OUT', [300, 300], [1386661, 1386661], 36], ['IN', [301, 301], [1386811, 1386811], 1460], ['OUT', [302, 302], [1386831, 1386831], 36], ['IN', [303, 306], [1387136, 1387136], 5840], ['OUT', [307, 307], [1387172, 1387172], 36], ['OUT', [308, 308], [1387208, 1387208], 36], ['OUT', [309, 309], [1387229, 1387229], 36], ['OUT', [310, 310], [1387257, 1387257], 36], ['IN', [311, 311], [1387675, 1387675], 1460], ['OUT', [312, 312], [1387701, 1387701], 36], ['IN', [313, 316], [1388193, 1388193], 5840], ['OUT', [317, 317], [1388238, 1388238], 36], ['OUT', [318, 318], [1388277, 1388277], 36], ['OUT', [319, 319], [1388298, 1388298], 36], ['OUT', [320, 320], [1388316, 1388316], 36], ['IN', [321, 322], [1388693, 1388693], 2920], ['OUT', [323, 323], [1388715, 1388715], 36], ['OUT', [324, 324], [1388745, 1388745], 36], ['IN', [325, 325], [1404215, 1404215], 1460], ['OUT', [326, 326], [1404259, 1404259], 36], ['IN', [327, 327], [1404475, 1404475], 1460], ['OUT', [328, 328], [1404501, 1404501], 36], ['IN', [329, 334], [1410729, 1410729], 8760], ['OUT', [335, 335], [1410829, 1410829], 36], ['OUT', [336, 336], [1410877, 1410877], 36], ['OUT', [337, 337], [1410906, 1410906], 36], ['OUT', [338, 338], [1410944, 1410944], 36], ['OUT', [339, 339], [1410984, 1410984], 36], ['OUT', [340, 340], [1411010, 1411010], 36], ['IN', [341, 345], [1411249, 1411249], 7300], ['OUT', [346, 346], [1411283, 1411283], 36], ['OUT', [347, 347], [1411311, 1411311], 36], ['OUT', [348, 348], [1411330, 1411330], 36], ['OUT', [349, 349], [1411346, 1411346], 36], ['OUT', [350, 350], [1411363, 1411363], 36], ['IN', [351, 354], [1412519, 1412519], 5840], ['OUT', [355, 355], [1412560, 1412560], 36], ['OUT', [356, 356], [1412590, 1412590], 36], ['OUT', [357, 357], [1412632, 1412632], 36], ['OUT', [358, 358], [1412669, 1412669], 36], ['IN', [359, 362], [1413213, 1413213], 5840], ['OUT', [363, 363], [1413259, 1413259], 36], ['OUT', [364, 364], [1413290, 1413290], 36], ['OUT', [365, 365], [1413315, 1413315], 36], ['OUT', [366, 366], [1413340, 1413340], 36], ['IN', [367, 373], [1413769, 1413769], 10220], ['OUT', [374, 374], [1413825, 1413825], 36], ['OUT', [375, 375], [1413869, 1413869], 36], ['OUT', [376, 376], [1413938, 1413938], 36], ['OUT', [377, 377], [1413971, 1413971], 36], ['OUT', [378, 378], [1413999, 1413999], 36], ['OUT', [379, 379], [1414022, 1414022], 36], ['OUT', [380, 380], [1414049, 1414049], 36], ['IN', [381, 382], [1414302, 1414302], 2920], ['OUT', [383, 383], [1414329, 1414329], 36], ['OUT', [384, 384], [1414366, 1414366], 28], ['IN', [385, 385], [1426713, 1426713], 1460], ['OUT', [386, 386], [1426763, 1426763], 28], ['IN', [387, 387], [1427227, 1427227], 1460], ['OUT', [388, 388], [1427248, 1427248], 28], ['IN', [389, 390], [1427867, 1427867], 2920], ['OUT', [391, 391], [1427896, 1427896], 20], ['OUT', [392, 392], [1427933, 1427933], 20], ['IN', [393, 393], [1433662, 1433662], 1460], ['OUT', [394, 394], [1433729, 1433729], 20], ['IN', [395, 395], [1434134, 1434134], 1460], ['OUT', [396, 396], [1434158, 1434158], 20], ['IN', [397, 401], [1436982, 1436982], 7300], ['OUT', [402, 402], [1437044, 1437044], 20], ['OUT', [403, 403], [1437085, 1437085], 20], ['OUT', [404, 404], [1437126, 1437126], 20], ['OUT', [405, 405], [1437148, 1437148], 20], ['OUT', [406, 406], [1437166, 1437166], 20], ['IN', [407, 416], [1437347, 1437347], 14600], ['OUT', [417, 417], [1437415, 1437415], 20], ['OUT', [418, 418], [1437454, 1437454], 20], ['OUT', [419, 426], [1437479, 1437813], 96], ['IN', [427, 430], [1438409, 1438409], 5840], ['OUT', [431, 434], [1438449, 1438579], 48], ['IN', [435, 540], [1439002, 1514796], 120073], ['OUT', [541, 542], [1514824, 1514855], 32], ['IN', [543, 545], [1515497, 1515497], 4380], ['OUT', [546, 548], [1515526, 1515580], 100], ['IN', [549, 549], [1522882, 1522882], 1460], ['OUT', [550, 550], [1522932, 1522932], 36], ['IN', [551, 553], [1523249, 1523249], 4380], ['OUT', [554, 556], [1523293, 1523373], 108], ['IN', [557, 562], [1524817, 1524817], 8760], ['OUT', [563, 568], [1524910, 1525076], 216], ['IN', [569, 573], [1525586, 1525586], 7300], ['OUT', [574, 578], [1525634, 1525769], 180], ['IN', [579, 581], [1526118, 1526118], 4380], ['OUT', [582, 584], [1526148, 1526196], 108], ['IN', [585, 585], [1526343, 1526343], 1460], ['OUT', [586, 586], [1526360, 1526360], 36], ['IN', [587, 588], [1526827, 1526827], 2920], ['OUT', [589, 590], [1526870, 1526928], 72], ['IN', [591, 591], [1527071, 1527071], 1460], ['OUT', [592, 592], [1527093, 1527093], 36], ['IN', [593, 593], [1527381, 1527381], 1460], ['OUT', [594, 594], [1527406, 1527406], 36], ['IN', [595, 596], [1528085, 1528085], 2920], ['OUT', [597, 598], [1528111, 1528148], 72], ['IN', [599, 600], [1528270, 1528270], 2920], ['OUT', [601, 602], [1528294, 1528331], 72], ['IN', [603, 603], [1528467, 1528467], 1460], ['OUT', [604, 604], [1528487, 1528487], 36], ['IN', [605, 606], [1528733, 1528733], 2920], ['OUT', [607, 608], [1528756, 1528792], 72], ['IN', [609, 609], [1529268, 1529268], 1460], ['OUT', [610, 610], [1529297, 1529297], 36], ['IN', [611, 611], [1529862, 1529862], 1460], ['OUT', [612, 612], [1529887, 1529887], 36], ['IN', [613, 613], [1530523, 1530523], 1460], ['OUT', [614, 614], [1530555, 1530555], 36], ['IN', [615, 616], [1530906, 1530906], 2920], ['OUT', [617, 618], [1530935, 1530967], 72], ['IN', [619, 619], [1531114, 1531114], 1460], ['OUT', [620, 620], [1531133, 1531133], 36], ['IN', [621, 621], [1531248, 1531248], 1460], ['OUT', [622, 622], [1531292, 1531292], 36], ['IN', [623, 624], [1531424, 1531424], 2920], ['OUT', [625, 626], [1531444, 1531477], 72], ['IN', [627, 627], [1531597, 1531597], 1460], ['OUT', [628, 628], [1531614, 1531614], 36], ['IN', [629, 629], [1532164, 1532164], 1460], ['OUT', [630, 630], [1532182, 1532182], 36], ['IN', [631, 632], [1532805, 1532805], 2920], ['OUT', [633, 634], [1532827, 1532861], 72], ['IN', [635, 639], [1533778, 1533778], 7300], ['OUT', [640, 644], [1533845, 1533960], 180], ['IN', [645, 649], [1534368, 1534368], 7300], ['OUT', [650, 654], [1534413, 1534535], 180], ['IN', [655, 657], [1535133, 1535133], 4380], ['OUT', [658, 660], [1535160, 1535209], 108], ['IN', [661, 663], [1535453, 1535453], 4380], ['OUT', [664, 666], [1535496, 1535553], 108], ['IN', [667, 667], [1535678, 1535678], 1460], ['OUT', [668, 668], [1535704, 1535704], 36], ['IN', [669, 670], [1536256, 1536256], 2920], ['OUT', [671, 672], [1536279, 1536309], 72], ['IN', [673, 673], [1536408, 1536408], 1460], ['OUT', [674, 674], [1536424, 1536424], 36], ['IN', [675, 678], [1536998, 1536998], 4541], ['OUT', [679, 682], [1537027, 1537090], 144], ['IN', [683, 683], [1537231, 1537231], 1460], ['OUT', [684, 684], [1537246, 1537246], 36], ['IN', [685, 686], [1537432, 1537432], 2920], ['OUT', [687, 687], [1537466, 1537466], 36], ['OUT', [688, 688], [1537494, 1537494], 36], ['IN', [689, 689], [1537679, 1537679], 1460], ['OUT', [690, 690], [1537701, 1537701], 36], ['IN', [691, 691], [1537950, 1537950], 1460], ['OUT', [692, 692], [1537977, 1537977], 36], ['IN', [693, 694], [1538366, 1538366], 2920], ['OUT', [695, 695], [1538385, 1538385], 36], ['OUT', [696, 696], [1538413, 1538413], 36], ['IN', [697, 697], [1545323, 1545323], 1460], ['OUT', [698, 698], [1545356, 1545356], 36], ['IN', [699, 699], [1545517, 1545517], 1460], ['OUT', [700, 700], [1545536, 1545536], 36], ['IN', [701, 704], [1546094, 1546094], 5840], ['OUT', [705, 705], [1546162, 1546162], 36], ['OUT', [706, 706], [1546193, 1546193], 36], ['OUT', [707, 707], [1546213, 1546213], 36], ['OUT', [708, 708], [1546233, 1546233], 36], ['IN', [709, 709], [1546731, 1546731], 1460], ['OUT', [710, 710], [1546764, 1546764], 36], ['IN', [711, 714], [1547559, 1547559], 5840], ['OUT', [715, 715], [1547592, 1547592], 36], ['OUT', [716, 716], [1547624, 1547624], 36], ['OUT', [717, 717], [1547640, 1547640], 36], ['OUT', [718, 718], [1547655, 1547655], 36], ['IN', [719, 722], [1548830, 1548830], 5840], ['OUT', [723, 723], [1548862, 1548862], 36], ['OUT', [724, 724], [1548895, 1548895], 36], ['OUT', [725, 725], [1548919, 1548919], 28], ['OUT', [726, 726], [1548939, 1548939], 28], ['IN', [727, 732], [1549120, 1549120], 8760], ['OUT', [733, 733], [1549176, 1549176], 28], ['OUT', [734, 734], [1549206, 1549206], 28], ['OUT', [735, 735], [1549222, 1549222], 28], ['OUT', [736, 736], [1549240, 1549240], 28], ['OUT', [737, 737], [1549274, 1549274], 28], ['OUT', [738, 738], [1549303, 1549303], 28], ['IN', [739, 741], [1549964, 1549964], 4380], ['OUT', [742, 742], [1549989, 1549989], 20], ['OUT', [743, 743], [1550039, 1550039], 20], ['OUT', [744, 744], [1550055, 1550055], 20], ['IN', [745, 747], [1550197, 1550197], 4380], ['OUT', [748, 748], [1550221, 1550221], 20], ['OUT', [749, 749], [1550250, 1550250], 20], ['OUT', [750, 750], [1550268, 1550268], 20], ['IN', [751, 751], [1550543, 1550543], 1460], ['OUT', [752, 752], [1550559, 1550559], 12], ['IN', [753, 754], [1550941, 1550941], 2920], ['OUT', [755, 755], [1550960, 1550960], 12], ['OUT', [756, 756], [1550988, 1550988], 12], ['IN', [757, 757], [1551091, 1551091], 1460], ['OUT', [758, 758], [1551121, 1551121], 12], ['IN', [759, 759], [1551276, 1551276], 1460], ['OUT', [760, 760], [1551289, 1551289], 12], ['IN', [761, 764], [1551753, 1551753], 5840], ['OUT', [765, 765], [1551779, 1551779], 12], ['OUT', [766, 766], [1551913, 1551913], 0], ['OUT', [767, 768], [1551952, 1552092], 0], ['IN', [769, 902], [1552214, 1665323], 135026], ['OUT', [903, 903], [1665342, 1665342], 12], ['IN', [904, 905], [1672915, 1672915], 2920], ['OUT', [906, 907], [1673068, 1673105], 24], ['IN', [908, 909], [1673345, 1673345], 2920], ['OUT', [910, 911], [1673366, 1673462], 24], ['IN', [912, 912], [1673652, 1673652], 1460], ['OUT', [913, 913], [1673760, 1673760], 12], ['IN', [914, 918], [1674056, 1674056], 7300], ['OUT', [919, 923], [1674107, 1674286], 60], ['IN', [924, 924], [1674623, 1674623], 1460], ['OUT', [925, 925], [1674643, 1674643], 12], ['IN', [926, 927], [1674823, 1674823], 2920], ['OUT', [928, 929], [1674861, 1674894], 24], ['IN', [930, 930], [1675005, 1675005], 1460], ['OUT', [931, 931], [1675029, 1675029], 12], ['IN', [932, 932], [1675309, 1675309], 1460], ['OUT', [933, 933], [1675324, 1675324], 12], ['IN', [934, 934], [1675676, 1675676], 1460], ['OUT', [935, 935], [1675695, 1675695], 12], ['IN', [936, 936], [1675860, 1675860], 1460], ['OUT', [937, 937], [1675876, 1675876], 12], ['IN', [938, 939], [1676023, 1676023], 2920], ['OUT', [940, 941], [1676045, 1676081], 24], ['IN', [942, 942], [1676225, 1676225], 1460], ['OUT', [943, 943], [1676258, 1676258], 12], ['IN', [944, 944], [1676392, 1676392], 1460], ['OUT', [945, 945], [1676408, 1676408], 12], ['IN', [946, 946], [1679554, 1679554], 1460], ['OUT', [947, 947], [1679586, 1679586], 12], ['IN', [948, 948], [1680116, 1680116], 1460], ['OUT', [949, 949], [1680136, 1680136], 12], ['IN', [950, 952], [1680430, 1680430], 4380], ['OUT', [953, 955], [1680479, 1680540], 36], ['IN', [956, 956], [1680713, 1680713], 1460], ['OUT', [957, 957], [1680751, 1680751], 12], ['IN', [958, 960], [1680923, 1680923], 4380], ['OUT', [961, 963], [1680949, 1681059], 36], ['IN', [964, 964], [1681242, 1681242], 1460], ['OUT', [965, 965], [1681278, 1681278], 12], ['IN', [966, 967], [1681434, 1681434], 2920], ['OUT', [968, 969], [1681477, 1681512], 24], ['IN', [970, 971], [1681705, 1681705], 2920], ['OUT', [972, 973], [1681723, 1681755], 24], ['IN', [974, 975], [1681862, 1681862], 2920], ['OUT', [976, 977], [1681880, 1681908], 24], ['IN', [978, 978], [1682013, 1682013], 1460], ['OUT', [979, 979], [1682030, 1682030], 12], ['IN', [980, 980], [1682388, 1682388], 1460], ['OUT', [981, 981], [1682404, 1682404], 12], ['IN', [982, 982], [1682520, 1682520], 1460], ['OUT', [983, 983], [1682552, 1682552], 12], ['IN', [984, 984], [1682688, 1682688], 1460], ['OUT', [985, 985], [1682721, 1682721], 12], ['IN', [986, 986], [1683273, 1683273], 1460], ['OUT', [987, 987], [1683293, 1683293], 12], ['IN', [988, 988], [1683441, 1683441], 1460], ['OUT', [989, 989], [1683478, 1683478], 12], ['IN', [990, 991], [1683728, 1683728], 2920], ['OUT', [992, 993], [1683750, 1683781], 24], ['IN', [994, 996], [1684315, 1684315], 4380], ['OUT', [997, 999], [1684340, 1684389], 36], ['IN', [1000, 1002], [1684578, 1684578], 4380], ['OUT', [1003, 1005], [1684625, 1684684], 36], ['IN', [1006, 1006], [1684985, 1684985], 1460], ['OUT', [1007, 1007], [1685006, 1685006], 12], ['IN', [1008, 1009], [1685353, 1685353], 2920], ['OUT', [1010, 1011], [1685371, 1685402], 24], ['IN', [1012, 1012], [1685724, 1685724], 1460], ['OUT', [1013, 1013], [1685738, 1685738], 12], ['IN', [1014, 1015], [1686069, 1686069], 2920], ['OUT', [1016, 1017], [1686087, 1686118], 24], ['IN', [1018, 1018], [1686904, 1686904], 1460], ['OUT', [1019, 1019], [1686921, 1686921], 12], ['IN', [1020, 1020], [1687165, 1687165], 1460], ['OUT', [1021, 1021], [1687182, 1687182], 12], ['IN', [1022, 1024], [1687855, 1687855], 4380], ['OUT', [1025, 1027], [1687898, 1687949], 36], ['IN', [1028, 1028], [1688243, 1688243], 1460], ['OUT', [1029, 1029], [1688259, 1688259], 12], ['IN', [1030, 1032], [1688384, 1688384], 4380], ['OUT', [1033, 1035], [1688407, 1688452], 36], ['IN', [1036, 1038], [1688987, 1688987], 4380], ['OUT', [1039, 1041], [1689016, 1689074], 36], ['IN', [1042, 1042], [1689228, 1689228], 1460], ['OUT', [1043, 1043], [1689249, 1689249], 12], ['IN', [1044, 1044], [1689432, 1689432], 1460], ['OUT', [1045, 1045], [1689450, 1689450], 12], ['IN', [1046, 1046], [1695236, 1695236], 1460], ['OUT', [1047, 1047], [1695276, 1695276], 12], ['IN', [1048, 1048], [1696056, 1696056], 1460], ['OUT', [1049, 1049], [1696074, 1696074], 12], ['IN', [1050, 1050], [1696534, 1696534], 1460], ['OUT', [1051, 1051], [1696552, 1696552], 12], ['IN', [1052, 1052], [1696692, 1696692], 1460], ['OUT', [1053, 1053], [1696705, 1696705], 12], ['IN', [1054, 1056], [1696967, 1696967], 4380], ['OUT', [1057, 1057], [1696999, 1696999], 12], ['OUT', [1058, 1058], [1697035, 1697035], 12], ['OUT', [1059, 1059], [1697054, 1697054], 12], ['IN', [1060, 1060], [1697191, 1697191], 1460], ['OUT', [1061, 1061], [1697206, 1697206], 12], ['IN', [1062, 1063], [1697561, 1697561], 2920], ['OUT', [1064, 1064], [1697579, 1697579], 12], ['OUT', [1065, 1065], [1697608, 1697608], 12], ['IN', [1066, 1066], [1698044, 1698044], 1460], ['OUT', [1067, 1067], [1698076, 1698076], 12], ['IN', [1068, 1068], [1698210, 1698210], 1460], ['OUT', [1069, 1069], [1698223, 1698223], 12], ['IN', [1070, 1072], [1700851, 1700851], 4380], ['OUT', [1073, 1073], [1700889, 1700889], 12], ['OUT', [1074, 1074], [1701023, 1701023], 0], ['OUT', [1075, 1076], [1701058, 1701483], 0], ['IN', [1077, 1379], [1703065, 66809639], 309047], ['OUT', [1380, 1380], [66809880, 66809880], 31], ['OUT', [1381, 1381], [66809996, 66809996], 0], ['IN', [1382, 1382], [66810343, 66810343], 0], ['OUT', [1383, 1383], [66810383, 66810383], 0], ['TERM_RST', [1384, 1384], [66833208, 66833208]], ['TERM_RST', [1385, 1385], [66833337, 66833337]], ['TERM_RST', [1386, 1386], [66833587, 66833587]]], [['HANDSHAKE', [0, 2], [0, 188610]], ['TLS_handshake', [3, 5], [188927, 378014]], ['OUT_TLS', [6, 8], [378458, 569049], 293], ['IN_TLS', [9, 10], [698491, 746029], 1253], ['OUT_TLS', [11, 12], [750481, 982508], 250], ['IN_TLS', [13, 13], [1062010, 1062010], 165], ['OUT_TLS', [14, 15], [1063317, 1251969], 234], ['IN_TLS', [16, 17], [1383649, 1433153], 981], ['OUT_TLS', [18, 21], [3419244, 3608183], 532], ['IN_TLS', [22, 24], [3752267, 68752386], 218], ['OUT_TLS', [25, 25], [68752506, 68752506], 37], ['OUT', [26, 26], [68752607, 68752607], 0], ['IN', [27, 27], [68752639, 68752639], 0], ['OUT', [28, 28], [68752665, 68752665], 0], ['TERM_RST', [29, 29], [68940571, 68940571]]], [['HANDSHAKE', [0, 2], [0, 186298]], ['TLS_handshake', [3, 5], [186636, 373914]], ['OUT_TLS', [6, 9], [379832, 566443], 607], ['IN_TLS', [10, 12], [707229, 65706437], 218], ['OUT_TLS', [13, 13], [65706641, 65706641], 37], ['OUT', [14, 14], [65706688, 65706688], 0], ['IN', [15, 15], [65707377, 65707377], 0], ['OUT', [16, 16], [65707421, 65707421], 0], ['TERM_RST', [17, 17], [65893127, 65893127]]], [['HANDSHAKE', [0, 2], [0, 451776]], ['OUT', [3, 6], [452202, 904687], 643], ['IN', [7, 7], [917699, 917699], 139], ['TERM', [8, 11], [917699, 1369152]]], [['HANDSHAKE', [0, 2], [0, 24980]], ['TLS_handshake', [3, 10], [25658, 82213]], ['OUT', [11, 11], [144482, 144482], 0], ['OUT_TLS', [12, 13], [178264, 202558], 187], ['IN_TLS', [14, 15], [202924, 270800], 221], ['IN', [16, 17], [5206087, 5206129], 0], ['OUT_TLS', [18, 18], [5206324, 5206324], 31], ['OUT', [19, 19], [5206371, 5206371], 0], ['TERM_RST', [20, 20], [5230399, 5230399]], ['TERM_RST', [21, 21], [5230609, 5230609]]], [['HANDSHAKE', [0, 2], [0, 8016]], ['OUT', [3, 4], [8725, 16620], 128]], [['HANDSHAKE_FAILED', [0, 1], [0, 158356]], ['HANDSHAKE_FAILED', [2, 3], [686880, 844979]], ['HANDSHAKE_FAILED', [4, 5], [1346748, 1506322]], ['HANDSHAKE_FAILED', [6, 7], [2018775, 2177819]], ['HANDSHAKE_FAILED', [8, 9], [2691264, 2849519]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158965]], ['HANDSHAKE_FAILED', [2, 3], [660058, 819553]], ['HANDSHAKE_FAILED', [4, 5], [1325726, 1483524]], ['HANDSHAKE_FAILED', [6, 7], [2011901, 2172071]], ['HANDSHAKE_FAILED', [8, 9], [2684446, 2842575]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158391]], ['HANDSHAKE_FAILED', [2, 3], [668171, 828024]], ['HANDSHAKE_FAILED', [4, 5], [1337250, 1497171]], ['HANDSHAKE_FAILED', [6, 7], [2008840, 2166746]], ['HANDSHAKE_FAILED', [8, 9], [2683270, 2842705]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157598]], ['HANDSHAKE_FAILED', [2, 3], [666023, 825209]], ['HANDSHAKE_FAILED', [4, 5], [1337547, 1496637]], ['HANDSHAKE_FAILED', [6, 7], [2009557, 2167565]], ['HANDSHAKE_FAILED', [8, 9], [2688856, 2848731]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157024]], ['HANDSHAKE_FAILED', [2, 3], [668766, 829882]], ['HANDSHAKE_FAILED', [4, 5], [1342465, 1500246]], ['HANDSHAKE_FAILED', [6, 7], [2013246, 2171816]], ['HANDSHAKE_FAILED', [8, 9], [2702934, 2860469]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156581]], ['HANDSHAKE_FAILED', [2, 3], [675554, 831863]], ['HANDSHAKE_FAILED', [4, 5], [1358286, 1514621]], ['HANDSHAKE_FAILED', [6, 7], [2029839, 2186682]], ['HANDSHAKE_FAILED', [8, 9], [2706540, 2862161]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155962]], ['HANDSHAKE_FAILED', [2, 3], [671319, 828345]], ['HANDSHAKE_FAILED', [4, 5], [1342350, 1499322]], ['HANDSHAKE_FAILED', [6, 7], [2014490, 2170611]], ['HANDSHAKE_FAILED', [8, 9], [2685857, 2844604]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157294]], ['HANDSHAKE_FAILED', [2, 3], [671488, 827057]], ['HANDSHAKE_FAILED', [4, 5], [1343477, 1499224]], ['HANDSHAKE_FAILED', [6, 7], [2015312, 2172970]], ['HANDSHAKE_FAILED', [8, 9], [2690413, 2846524]]], [['HANDSHAKE', [0, 2], [0, 781855]], ['OUT', [3, 6], [782010, 1234806], 656], ['IN', [7, 7], [1291687, 1291687], 139], ['TERM', [8, 11], [1291687, 1747537]]], [['HANDSHAKE_FAILED', [0, 1], [0, 625540]], ['HANDSHAKE_FAILED', [2, 3], [1137027, 1292527]], ['HANDSHAKE_FAILED', [4, 5], [1794491, 1950613]], ['HANDSHAKE_FAILED', [6, 7], [2465482, 2621380]], ['HANDSHAKE_FAILED', [8, 9], [3137085, 3292017]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157836]], ['HANDSHAKE_FAILED', [2, 3], [668846, 826714]], ['HANDSHAKE_FAILED', [4, 5], [1328658, 1488396]], ['HANDSHAKE_FAILED', [6, 7], [1998733, 2157244]], ['HANDSHAKE_FAILED', [8, 9], [2661004, 2820641]]], [['HANDSHAKE_FAILED', [0, 1], [0, 159199]], ['HANDSHAKE_FAILED', [2, 3], [668934, 827251]], ['HANDSHAKE_FAILED', [4, 5], [1347041, 1505116]], ['HANDSHAKE_FAILED', [6, 7], [2018044, 2175967]], ['HANDSHAKE_FAILED', [8, 9], [2690078, 2848511]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158618]], ['HANDSHAKE_FAILED', [2, 3], [670534, 828534]], ['HANDSHAKE_FAILED', [4, 5], [1342616, 1500658]], ['HANDSHAKE_FAILED', [6, 7], [2005416, 2163312]], ['HANDSHAKE_FAILED', [8, 9], [2675945, 2834331]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15038820]]], [['HANDSHAKE_FAILED', [0, 1], [0, 162702]], ['HANDSHAKE_FAILED', [2, 3], [671082, 829119]], ['HANDSHAKE_FAILED', [4, 5], [1343036, 1501549]], ['HANDSHAKE_FAILED', [6, 7], [2014599, 2179323]], ['HANDSHAKE_FAILED', [8, 9], [2681787, 2840654]]], [['HANDSHAKE_FAILED', [0, 1], [0, 160159]], ['HANDSHAKE_FAILED', [2, 3], [668002, 827691]], ['HANDSHAKE_FAILED', [4, 5], [1334146, 1492680]], ['HANDSHAKE_FAILED', [6, 7], [2002997, 2163543]], ['HANDSHAKE_FAILED', [8, 9], [2693370, 2851766]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155527]], ['HANDSHAKE_FAILED', [2, 3], [660393, 815964]], ['HANDSHAKE_FAILED', [4, 5], [1326141, 1481807]], ['HANDSHAKE_FAILED', [6, 7], [1988881, 2143791]], ['HANDSHAKE_FAILED', [8, 9], [2671335, 2826123]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155238]], ['HANDSHAKE_FAILED', [2, 3], [655522, 810790]], ['HANDSHAKE_FAILED', [4, 5], [1315352, 1469945]], ['HANDSHAKE_FAILED', [6, 7], [1983948, 2138695]], ['HANDSHAKE_FAILED', [8, 9], [2640387, 2796318]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155672]], ['HANDSHAKE_FAILED', [2, 3], [660871, 818341]], ['HANDSHAKE_FAILED', [4, 5], [1344595, 1500419]], ['HANDSHAKE_FAILED', [6, 7], [2014369, 2170147]], ['HANDSHAKE_FAILED', [8, 9], [2670630, 2826196]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15026686]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155113]], ['HANDSHAKE_FAILED', [2, 3], [670236, 824796]], ['HANDSHAKE_FAILED', [4, 5], [1344229, 1499628]], ['HANDSHAKE_FAILED', [6, 7], [2002585, 2157918]], ['HANDSHAKE_FAILED', [8, 9], [2658063, 2813293]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157740]], ['HANDSHAKE_FAILED', [2, 3], [671345, 830848]], ['HANDSHAKE_FAILED', [4, 5], [1342476, 1502165]], ['HANDSHAKE_FAILED', [6, 7], [2014563, 2172682]], ['HANDSHAKE_FAILED', [8, 9], [2686655, 2844011]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158425]], ['HANDSHAKE_FAILED', [2, 3], [669661, 827886]], ['HANDSHAKE_FAILED', [4, 5], [1347054, 1507231]], ['HANDSHAKE_FAILED', [6, 7], [2020968, 2180547]], ['HANDSHAKE_FAILED', [8, 9], [2685027, 2842500]]], [['HANDSHAKE_FAILED', [0, 1], [0, 160034]], ['HANDSHAKE_FAILED', [2, 3], [668993, 826998]], ['HANDSHAKE_FAILED', [4, 5], [1350318, 1506863]], ['HANDSHAKE_FAILED', [6, 7], [2012685, 2180750]], ['HANDSHAKE_FAILED', [8, 9], [2701684, 2859848]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157389]], ['HANDSHAKE_FAILED', [2, 3], [670966, 829462]], ['HANDSHAKE_FAILED', [4, 5], [1329791, 1492525]], ['HANDSHAKE_FAILED', [6, 7], [1999865, 2159512]], ['HANDSHAKE_FAILED', [8, 9], [2668926, 2827996]]], [['HANDSHAKE_FAILED', [0, 1], [0, 162843]], ['HANDSHAKE_FAILED', [2, 3], [684586, 843865]], ['HANDSHAKE_FAILED', [4, 5], [1348753, 1508473]], ['HANDSHAKE_FAILED', [6, 7], [2010077, 2168999]], ['HANDSHAKE_FAILED', [8, 9], [2683117, 2841116]]], [['HANDSHAKE_FAILED', [0, 1], [0, 167476]], ['HANDSHAKE_FAILED', [2, 3], [680622, 841002]], ['HANDSHAKE_FAILED', [4, 5], [1353875, 1516947]], ['HANDSHAKE_FAILED', [6, 7], [2024558, 2182420]], ['HANDSHAKE_FAILED', [8, 9], [2712069, 2871426]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15182145]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158605]], ['HANDSHAKE_FAILED', [2, 3], [668067, 827169]], ['HANDSHAKE_FAILED', [4, 5], [1340623, 1499907]], ['HANDSHAKE_FAILED', [6, 7], [2017045, 2177438]], ['HANDSHAKE_FAILED', [8, 9], [2688381, 2847651]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158166]], ['HANDSHAKE_FAILED', [2, 3], [670283, 828055]], ['HANDSHAKE_FAILED', [4, 5], [1331488, 1495551]], ['HANDSHAKE_FAILED', [6, 7], [2000577, 2158112]], ['HANDSHAKE_FAILED', [8, 9], [2667692, 2826336]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158066]], ['HANDSHAKE_FAILED', [2, 3], [683217, 841617]], ['HANDSHAKE_FAILED', [4, 5], [1352449, 1512948]], ['HANDSHAKE_FAILED', [6, 7], [2019786, 2177555]], ['HANDSHAKE_FAILED', [8, 9], [2683909, 2842605]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157771]], ['HANDSHAKE_FAILED', [2, 3], [671116, 830661]], ['HANDSHAKE_FAILED', [4, 5], [1337281, 1494405]], ['HANDSHAKE_FAILED', [6, 7], [2001659, 2161503]], ['HANDSHAKE_FAILED', [8, 9], [2676030, 2833911]]], [['HANDSHAKE_FAILED', [0, 1], [0, 160048]], ['HANDSHAKE_FAILED', [2, 3], [669371, 828957]], ['HANDSHAKE_FAILED', [4, 5], [1342893, 1501322]], ['HANDSHAKE_FAILED', [6, 7], [2010632, 2169197]], ['HANDSHAKE_FAILED', [8, 9], [2679483, 2837785]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157299]], ['HANDSHAKE_FAILED', [2, 3], [665278, 822967]], ['HANDSHAKE_FAILED', [4, 5], [1332267, 1490001]], ['HANDSHAKE_FAILED', [6, 7], [2001446, 2159781]], ['HANDSHAKE_FAILED', [8, 9], [2747576, 2907549]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158585]], ['HANDSHAKE_FAILED', [2, 3], [669695, 829846]], ['HANDSHAKE_FAILED', [4, 5], [1339868, 1498579]], ['HANDSHAKE_FAILED', [6, 7], [2054811, 2213142]], ['HANDSHAKE_FAILED', [8, 9], [2756567, 2914962]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158086]], ['HANDSHAKE_FAILED', [2, 3], [671168, 832721]], ['HANDSHAKE_FAILED', [4, 5], [1417771, 1576150]], ['HANDSHAKE_FAILED', [6, 7], [2119630, 2286107]], ['HANDSHAKE_FAILED', [8, 9], [2812635, 2972898]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158271]], ['HANDSHAKE_FAILED', [2, 3], [685624, 842959]], ['HANDSHAKE_FAILED', [4, 5], [1385590, 1562601]], ['HANDSHAKE_FAILED', [6, 7], [2176800, 2334990]], ['HANDSHAKE_FAILED', [8, 9], [2990890, 3149226]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157210]], ['HANDSHAKE_FAILED', [2, 3], [720435, 878423]], ['HANDSHAKE_FAILED', [4, 5], [1431907, 1589718]], ['HANDSHAKE_FAILED', [6, 7], [2229345, 2388432]], ['HANDSHAKE_FAILED', [8, 9], [3025076, 3182961]]], [['HANDSHAKE_FAILED', [0, 1], [0, 160660]], ['HANDSHAKE_FAILED', [2, 3], [806101, 963962]], ['HANDSHAKE_FAILED', [4, 5], [1603630, 1762985]], ['HANDSHAKE_FAILED', [6, 7], [2399367, 2559247]], ['HANDSHAKE_FAILED', [8, 9], [3070052, 3228041]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157714]], ['HANDSHAKE_FAILED', [2, 3], [761345, 920174]], ['HANDSHAKE_FAILED', [4, 5], [1546474, 1705926]], ['HANDSHAKE_FAILED', [6, 7], [2260906, 2420051]], ['HANDSHAKE_FAILED', [8, 9], [2932954, 3092568]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158149]], ['HANDSHAKE_FAILED', [2, 3], [704355, 863981]], ['HANDSHAKE_FAILED', [4, 5], [1402676, 1562684]], ['HANDSHAKE_FAILED', [6, 7], [2074400, 2232280]], ['HANDSHAKE_FAILED', [8, 9], [2745023, 2903191]]], [['HANDSHAKE_FAILED', [0, 1], [0, 160311]], ['HANDSHAKE_FAILED', [2, 3], [809829, 967626]], ['HANDSHAKE_FAILED', [4, 5], [1480576, 1638363]], ['HANDSHAKE_FAILED', [6, 7], [2152116, 2313342]], ['HANDSHAKE_FAILED', [8, 9], [2819810, 2977726]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158930]], ['HANDSHAKE_FAILED', [2, 3], [742227, 900267]], ['HANDSHAKE_FAILED', [4, 5], [1415631, 1574658]], ['HANDSHAKE_FAILED', [6, 7], [2085089, 2241969]], ['HANDSHAKE_FAILED', [8, 9], [2767627, 2926039]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157651]], ['HANDSHAKE_FAILED', [2, 3], [673255, 830845]], ['HANDSHAKE_FAILED', [4, 5], [1343257, 1500894]], ['HANDSHAKE_FAILED', [6, 7], [2133405, 2290575]], ['HANDSHAKE_FAILED', [8, 9], [2939426, 3097521]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157416]], ['HANDSHAKE_FAILED', [2, 3], [662652, 821404]], ['HANDSHAKE_FAILED', [4, 5], [1468171, 1627898]], ['HANDSHAKE_FAILED', [6, 7], [2274302, 2432599]], ['HANDSHAKE_FAILED', [8, 9], [2933253, 3091253]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15067245]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157495]], ['HANDSHAKE_FAILED', [2, 3], [665087, 823976]], ['HANDSHAKE_FAILED', [4, 5], [1365312, 1522915]], ['HANDSHAKE_FAILED', [6, 7], [2026569, 2184403]], ['HANDSHAKE_FAILED', [8, 9], [2706442, 2873753]]], [['HANDSHAKE_FAILED', [0, 1], [0, 159443]], ['HANDSHAKE_FAILED', [2, 3], [741616, 900116]], ['HANDSHAKE_FAILED', [4, 5], [1547669, 1707290]], ['HANDSHAKE_FAILED', [6, 7], [2222161, 2380086]], ['HANDSHAKE_FAILED', [8, 9], [2892350, 3053404]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158392]], ['HANDSHAKE_FAILED', [2, 3], [711069, 869511]], ['HANDSHAKE_FAILED', [4, 5], [1397241, 1556413]], ['HANDSHAKE_FAILED', [6, 7], [2069732, 2226883]], ['HANDSHAKE_FAILED', [8, 9], [2752988, 2913121]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155340]], ['HANDSHAKE_FAILED', [2, 3], [669597, 824857]], ['HANDSHAKE_FAILED', [4, 5], [1326963, 1482875]], ['HANDSHAKE_FAILED', [6, 7], [1995355, 2150937]], ['HANDSHAKE_FAILED', [8, 9], [2670072, 2826299]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158093]], ['HANDSHAKE_FAILED', [2, 3], [666485, 825987]], ['HANDSHAKE_FAILED', [4, 5], [1344420, 1502428]], ['HANDSHAKE_FAILED', [6, 7], [2010753, 2168441]], ['HANDSHAKE_FAILED', [8, 9], [2682023, 2844916]]], [['HANDSHAKE_FAILED', [0, 1], [0, 167314]], ['HANDSHAKE_FAILED', [2, 3], [673939, 833463]], ['HANDSHAKE_FAILED', [4, 5], [1340831, 1499223]], ['HANDSHAKE_FAILED', [6, 7], [2014784, 2183064]], ['HANDSHAKE_FAILED', [8, 9], [2686028, 2845565]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158779]], ['HANDSHAKE_FAILED', [2, 3], [684446, 846017]], ['HANDSHAKE_FAILED', [4, 5], [1362725, 1520172]], ['HANDSHAKE_FAILED', [6, 7], [2028811, 2188353]], ['HANDSHAKE_FAILED', [8, 9], [2699553, 2860482]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158062]], ['HANDSHAKE_FAILED', [2, 3], [666289, 826019]], ['HANDSHAKE_FAILED', [4, 5], [1338246, 1496305]], ['HANDSHAKE_FAILED', [6, 7], [2010323, 2170072]], ['HANDSHAKE_FAILED', [8, 9], [2681317, 3009110]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156261]], ['HANDSHAKE_FAILED', [2, 3], [665052, 820371]], ['HANDSHAKE_FAILED', [4, 5], [1321465, 1476766]], ['HANDSHAKE_FAILED', [6, 7], [1993119, 2147829]], ['HANDSHAKE_FAILED', [8, 9], [2651479, 3003814]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157588]], ['HANDSHAKE_FAILED', [2, 3], [659616, 817287]], ['HANDSHAKE_FAILED', [4, 5], [1336896, 1494709]], ['HANDSHAKE_FAILED', [6, 7], [2005943, 2685105]], ['HANDSHAKE_FAILED', [8, 9], [3196625, 3364562]]], [['HANDSHAKE_FAILED', [0, 1], [0, 159584]], ['HANDSHAKE_FAILED', [2, 3], [669320, 827532]], ['HANDSHAKE_FAILED', [4, 5], [1331639, 1489614]], ['HANDSHAKE_FAILED', [6, 7], [1997843, 2399629]], ['HANDSHAKE_FAILED', [8, 9], [2909564, 3076062]]], [['HANDSHAKE_FAILED', [0, 1], [0, 159508]], ['HANDSHAKE_FAILED', [2, 3], [665330, 824157]], ['HANDSHAKE_FAILED', [4, 5], [1336884, 1892695]], ['HANDSHAKE_FAILED', [6, 7], [2401495, 2564423]], ['HANDSHAKE_FAILED', [8, 9], [3093982, 3252716]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155798]], ['HANDSHAKE_FAILED', [2, 3], [672979, 1349679]], ['HANDSHAKE_FAILED', [4, 5], [1858410, 2013944]], ['HANDSHAKE_FAILED', [6, 7], [2520713, 2676018]], ['HANDSHAKE_FAILED', [8, 9], [3192412, 3348288]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156973]], ['HANDSHAKE_FAILED', [2, 3], [670512, 1241419]], ['HANDSHAKE_FAILED', [4, 5], [1750200, 1910768]], ['HANDSHAKE_FAILED', [6, 7], [2412503, 2570943]], ['HANDSHAKE_FAILED', [8, 9], [3084288, 3242339]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158831]], ['HANDSHAKE_FAILED', [2, 3], [661683, 867808]], ['HANDSHAKE_FAILED', [4, 5], [1374560, 1542088]], ['HANDSHAKE_FAILED', [6, 7], [2045733, 2204828]], ['HANDSHAKE_FAILED', [8, 9], [2720179, 2877350]]], [['HANDSHAKE_FAILED', [0, 1], [0, 544754]], ['HANDSHAKE_FAILED', [2, 3], [1058699, 1215335]], ['HANDSHAKE_FAILED', [4, 5], [1730009, 1885692]], ['HANDSHAKE_FAILED', [6, 7], [2388410, 2546097]], ['HANDSHAKE_FAILED', [8, 9], [3070241, 3226272]]], [['HANDSHAKE_FAILED', [0, 1], [0, 399564]], ['HANDSHAKE_FAILED', [2, 3], [909217, 1076784]], ['HANDSHAKE_FAILED', [4, 5], [1580446, 1738313]], ['HANDSHAKE_FAILED', [6, 7], [2238816, 2399103]], ['HANDSHAKE_FAILED', [8, 9], [2920664, 3078991]]], [['HANDSHAKE_FAILED', [0, 1], [0, 159767]], ['HANDSHAKE_FAILED', [2, 3], [660306, 817919]], ['HANDSHAKE_FAILED', [4, 5], [1330433, 1490441]], ['HANDSHAKE_FAILED', [6, 7], [1998517, 2158286]], ['HANDSHAKE_FAILED', [8, 9], [2659348, 2818421]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155132]], ['HANDSHAKE_FAILED', [2, 3], [656448, 813039]], ['HANDSHAKE_FAILED', [4, 5], [1337946, 1495385]], ['HANDSHAKE_FAILED', [6, 7], [2012930, 2168230]], ['HANDSHAKE_FAILED', [8, 9], [2672318, 2827830]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154713]], ['HANDSHAKE_FAILED', [2, 3], [657618, 815071]], ['HANDSHAKE_FAILED', [4, 5], [1324162, 1478973]], ['HANDSHAKE_FAILED', [6, 7], [1986299, 2141433]], ['HANDSHAKE_FAILED', [8, 9], [2648031, 2804082]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158837]], ['HANDSHAKE_FAILED', [2, 3], [679748, 838613]], ['HANDSHAKE_FAILED', [4, 5], [1354716, 1516277]], ['HANDSHAKE_FAILED', [6, 7], [2039356, 2197595]], ['HANDSHAKE_FAILED', [8, 9], [2712312, 2871917]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158296]], ['HANDSHAKE_FAILED', [2, 3], [679440, 839379]], ['HANDSHAKE_FAILED', [4, 5], [1354445, 1515987]], ['HANDSHAKE_FAILED', [6, 7], [2039022, 2197905]], ['HANDSHAKE_FAILED', [8, 9], [2712058, 2870853]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157778]], ['HANDSHAKE_FAILED', [2, 3], [672259, 830165]], ['HANDSHAKE_FAILED', [4, 5], [1345152, 1504011]], ['HANDSHAKE_FAILED', [6, 7], [2018159, 2177652]], ['HANDSHAKE_FAILED', [8, 9], [2687225, 2846268]]], [['HANDSHAKE_FAILED', [0, 1], [0, 159476]], ['HANDSHAKE_FAILED', [2, 3], [667435, 827478]], ['HANDSHAKE_FAILED', [4, 5], [1355307, 1513540]], ['HANDSHAKE_FAILED', [6, 7], [2028993, 2186536]], ['HANDSHAKE_FAILED', [8, 9], [2697150, 2854812]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155164]], ['HANDSHAKE_FAILED', [2, 3], [669575, 826626]], ['HANDSHAKE_FAILED', [4, 5], [1345473, 1499924]], ['HANDSHAKE_FAILED', [6, 7], [2009720, 2165448]], ['HANDSHAKE_FAILED', [8, 9], [2668169, 2823295]]], [['HANDSHAKE_FAILED', [0, 1], [0, 161586]], ['HANDSHAKE_FAILED', [2, 3], [673895, 831907]], ['HANDSHAKE_FAILED', [4, 5], [1342982, 1502303]], ['HANDSHAKE_FAILED', [6, 7], [2013088, 2173141]], ['HANDSHAKE_FAILED', [8, 9], [2680770, 2838769]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154693]], ['HANDSHAKE_FAILED', [2, 3], [667751, 826045]], ['HANDSHAKE_FAILED', [4, 5], [1337838, 1495113]], ['HANDSHAKE_FAILED', [6, 7], [2005484, 2161015]], ['HANDSHAKE_FAILED', [8, 9], [2665333, 2820978]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157637]], ['HANDSHAKE_FAILED', [2, 3], [667463, 825698]], ['HANDSHAKE_FAILED', [4, 5], [1337537, 1497608]], ['HANDSHAKE_FAILED', [6, 7], [2005307, 2162693]], ['HANDSHAKE_FAILED', [8, 9], [2665037, 2824835]]], [['HANDSHAKE_FAILED', [0, 1], [0, 161357]], ['HANDSHAKE_FAILED', [2, 3], [670120, 828295]], ['HANDSHAKE_FAILED', [4, 5], [1342461, 1500500]], ['HANDSHAKE_FAILED', [6, 7], [2013578, 2172084]], ['HANDSHAKE_FAILED', [8, 9], [2671907, 2831135]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15045588]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156100]], ['HANDSHAKE_FAILED', [2, 3], [668114, 823427]], ['HANDSHAKE_FAILED', [4, 5], [1329695, 1486520]], ['HANDSHAKE_FAILED', [6, 7], [1995677, 2152973]], ['HANDSHAKE_FAILED', [8, 9], [2654586, 2809848]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158158]], ['HANDSHAKE_FAILED', [2, 3], [662934, 821967]], ['HANDSHAKE_FAILED', [4, 5], [1335958, 1496754]], ['HANDSHAKE_FAILED', [6, 7], [2008929, 2166938]], ['HANDSHAKE_FAILED', [8, 9], [2680940, 2850872]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154980]], ['HANDSHAKE_FAILED', [2, 3], [684942, 840132]], ['HANDSHAKE_FAILED', [4, 5], [1350966, 1506156]], ['HANDSHAKE_FAILED', [6, 7], [2009871, 2164851]], ['HANDSHAKE_FAILED', [8, 9], [2665805, 2820714]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155752]], ['HANDSHAKE_FAILED', [2, 3], [670944, 827773]], ['HANDSHAKE_FAILED', [4, 5], [1328305, 1482711]], ['HANDSHAKE_FAILED', [6, 7], [1997901, 2152589]], ['HANDSHAKE_FAILED', [8, 9], [2654580, 2810426]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158833]], ['HANDSHAKE_FAILED', [2, 3], [663995, 821400]], ['HANDSHAKE_FAILED', [4, 5], [1329233, 1486512]], ['HANDSHAKE_FAILED', [6, 7], [2007106, 2166164]], ['HANDSHAKE_FAILED', [8, 9], [2689064, 2847947]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155786]], ['HANDSHAKE_FAILED', [2, 3], [656694, 811424]], ['HANDSHAKE_FAILED', [4, 5], [1312852, 1468730]], ['HANDSHAKE_FAILED', [6, 7], [1982248, 2137868]], ['HANDSHAKE_FAILED', [8, 9], [2642334, 2799298]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157165]], ['HANDSHAKE_FAILED', [2, 3], [658385, 818247]], ['HANDSHAKE_FAILED', [4, 5], [1318201, 1476339]], ['HANDSHAKE_FAILED', [6, 7], [1983573, 2142021]], ['HANDSHAKE_FAILED', [8, 9], [2655400, 2813686]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157103]], ['HANDSHAKE_FAILED', [2, 3], [683364, 844465]], ['HANDSHAKE_FAILED', [4, 5], [1344632, 1502574]], ['HANDSHAKE_FAILED', [6, 7], [2025435, 2183011]], ['HANDSHAKE_FAILED', [8, 9], [2696429, 2854944]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154821]], ['HANDSHAKE_FAILED', [2, 3], [670369, 825621]], ['HANDSHAKE_FAILED', [4, 5], [1339769, 1495280]], ['HANDSHAKE_FAILED', [6, 7], [1999829, 2155483]], ['HANDSHAKE_FAILED', [8, 9], [2668197, 2823906]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158104]], ['HANDSHAKE_FAILED', [2, 3], [662604, 819743]], ['HANDSHAKE_FAILED', [4, 5], [1332130, 1492095]], ['HANDSHAKE_FAILED', [6, 7], [2020952, 2179070]], ['HANDSHAKE_FAILED', [8, 9], [2691429, 2848511]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155906]], ['HANDSHAKE_FAILED', [2, 3], [667783, 823417]], ['HANDSHAKE_FAILED', [4, 5], [1339928, 1495197]], ['HANDSHAKE_FAILED', [6, 7], [1995827, 2151181]], ['HANDSHAKE_FAILED', [8, 9], [2654563, 2810444]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158033]], ['HANDSHAKE_FAILED', [2, 3], [667567, 826054]], ['HANDSHAKE_FAILED', [4, 5], [1339706, 1498260]], ['HANDSHAKE_FAILED', [6, 7], [2011581, 2169363]], ['HANDSHAKE_FAILED', [8, 9], [2669433, 2826901]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158315]], ['HANDSHAKE_FAILED', [2, 3], [659710, 819361]], ['HANDSHAKE_FAILED', [4, 5], [1319540, 1476840]], ['HANDSHAKE_FAILED', [6, 7], [1986729, 2144588]], ['HANDSHAKE_FAILED', [8, 9], [2659640, 2816863]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156521]], ['HANDSHAKE_FAILED', [2, 3], [671215, 826604]], ['HANDSHAKE_FAILED', [4, 5], [1327515, 1483130]], ['HANDSHAKE_FAILED', [6, 7], [1998551, 2155305]], ['HANDSHAKE_FAILED', [8, 9], [2656059, 2811693]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157844]], ['HANDSHAKE_FAILED', [2, 3], [666873, 824607]], ['HANDSHAKE_FAILED', [4, 5], [1338109, 1497288]], ['HANDSHAKE_FAILED', [6, 7], [2011418, 2170833]], ['HANDSHAKE_FAILED', [8, 9], [2671218, 2828932]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156014]], ['HANDSHAKE_FAILED', [2, 3], [663445, 818605]], ['HANDSHAKE_FAILED', [4, 5], [1319407, 1475844]], ['HANDSHAKE_FAILED', [6, 7], [1978228, 2133666]], ['HANDSHAKE_FAILED', [8, 9], [2649734, 2810291]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155589]], ['HANDSHAKE_FAILED', [2, 3], [655146, 810706]], ['HANDSHAKE_FAILED', [4, 5], [1326168, 1481546]], ['HANDSHAKE_FAILED', [6, 7], [1983620, 2138740]], ['HANDSHAKE_FAILED', [8, 9], [2639950, 2794727]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154895]], ['HANDSHAKE_FAILED', [2, 3], [667636, 822610]], ['HANDSHAKE_FAILED', [4, 5], [1324261, 1479822]], ['HANDSHAKE_FAILED', [6, 7], [1983556, 2139827]], ['HANDSHAKE_FAILED', [8, 9], [2653372, 2809747]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155449]], ['HANDSHAKE_FAILED', [2, 3], [657260, 812258]], ['HANDSHAKE_FAILED', [4, 5], [1315084, 1470323]], ['HANDSHAKE_FAILED', [6, 7], [1986519, 2142213]], ['HANDSHAKE_FAILED', [8, 9], [2657082, 2812805]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158178]], ['HANDSHAKE_FAILED', [2, 3], [660108, 818571]], ['HANDSHAKE_FAILED', [4, 5], [1332871, 1490950]], ['HANDSHAKE_FAILED', [6, 7], [1991556, 2149328]], ['HANDSHAKE_FAILED', [8, 9], [2663790, 2822071]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156051]], ['HANDSHAKE_FAILED', [2, 3], [677300, 833193]], ['HANDSHAKE_FAILED', [4, 5], [1333709, 1488934]], ['HANDSHAKE_FAILED', [6, 7], [1989681, 2144522]], ['HANDSHAKE_FAILED', [8, 9], [2645669, 2802138]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157390]], ['HANDSHAKE_FAILED', [2, 3], [661147, 818950]], ['HANDSHAKE_FAILED', [4, 5], [1319928, 1477169]], ['HANDSHAKE_FAILED', [6, 7], [2007598, 2165745]], ['HANDSHAKE_FAILED', [8, 9], [2677577, 2835712]]], [['HANDSHAKE_FAILED', [0, 1], [0, 159200]], ['HANDSHAKE_FAILED', [2, 3], [670869, 830524]], ['HANDSHAKE_FAILED', [4, 5], [1342614, 1503270]], ['HANDSHAKE_FAILED', [6, 7], [2014401, 2172976]], ['HANDSHAKE_FAILED', [8, 9], [2686044, 2845482]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156062]], ['HANDSHAKE_FAILED', [2, 3], [658802, 813178]], ['HANDSHAKE_FAILED', [4, 5], [1315399, 1470613]], ['HANDSHAKE_FAILED', [6, 7], [1971812, 2127915]], ['HANDSHAKE_FAILED', [8, 9], [2628279, 2782805]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158184]], ['HANDSHAKE_FAILED', [2, 3], [668005, 825888]], ['HANDSHAKE_FAILED', [4, 5], [1339860, 1500759]], ['HANDSHAKE_FAILED', [6, 7], [2028706, 2188047]], ['HANDSHAKE_FAILED', [8, 9], [2699156, 2858809]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155224]], ['HANDSHAKE_FAILED', [2, 3], [657441, 812918]], ['HANDSHAKE_FAILED', [4, 5], [1314518, 1471318]], ['HANDSHAKE_FAILED', [6, 7], [1985632, 2141302]], ['HANDSHAKE_FAILED', [8, 9], [2642398, 2797923]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158010]], ['HANDSHAKE_FAILED', [2, 3], [670576, 830362]], ['HANDSHAKE_FAILED', [4, 5], [1343874, 1504086]], ['HANDSHAKE_FAILED', [6, 7], [2030501, 2188398]], ['HANDSHAKE_FAILED', [8, 9], [2701953, 2860540]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155412]], ['HANDSHAKE_FAILED', [2, 3], [671319, 827165]], ['HANDSHAKE_FAILED', [4, 5], [1328361, 1483203]], ['HANDSHAKE_FAILED', [6, 7], [1984204, 2139287]], ['HANDSHAKE_FAILED', [8, 9], [2655785, 2810638]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155563]], ['HANDSHAKE_FAILED', [2, 3], [683281, 838468]], ['HANDSHAKE_FAILED', [4, 5], [1340946, 1496364]], ['HANDSHAKE_FAILED', [6, 7], [2012805, 2167893]], ['HANDSHAKE_FAILED', [8, 9], [2669302, 2825063]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155304]], ['HANDSHAKE_FAILED', [2, 3], [667234, 822642]], ['HANDSHAKE_FAILED', [4, 5], [1323982, 1479886]], ['HANDSHAKE_FAILED', [6, 7], [1980354, 2135320]], ['HANDSHAKE_FAILED', [8, 9], [2635874, 2791085]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156370]], ['HANDSHAKE_FAILED', [2, 3], [685421, 841126]], ['HANDSHAKE_FAILED', [4, 5], [1356458, 1512096]], ['HANDSHAKE_FAILED', [6, 7], [2012431, 2168271]], ['HANDSHAKE_FAILED', [8, 9], [2693251, 2849245]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15059308]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155429]], ['HANDSHAKE_FAILED', [2, 3], [669984, 825417]], ['HANDSHAKE_FAILED', [4, 5], [1325865, 1481748]], ['HANDSHAKE_FAILED', [6, 7], [2006670, 2161371]], ['HANDSHAKE_FAILED', [8, 9], [2662074, 2818889]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155674]], ['HANDSHAKE_FAILED', [2, 3], [670502, 826176]], ['HANDSHAKE_FAILED', [4, 5], [1342173, 1497294]], ['HANDSHAKE_FAILED', [6, 7], [2014194, 2169838]], ['HANDSHAKE_FAILED', [8, 9], [2674593, 2830465]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157295]], ['HANDSHAKE_FAILED', [2, 3], [670952, 828904]], ['HANDSHAKE_FAILED', [4, 5], [1341983, 1499278]], ['HANDSHAKE_FAILED', [6, 7], [2013477, 2172690]], ['HANDSHAKE_FAILED', [8, 9], [2685938, 2842999]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158099]], ['HANDSHAKE_FAILED', [2, 3], [670585, 833651]], ['HANDSHAKE_FAILED', [4, 5], [1342632, 1501161]], ['HANDSHAKE_FAILED', [6, 7], [2003031, 2161427]], ['HANDSHAKE_FAILED', [8, 9], [2663238, 2821743]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155045]], ['HANDSHAKE_FAILED', [2, 3], [665669, 821748]], ['HANDSHAKE_FAILED', [4, 5], [1325068, 1480849]], ['HANDSHAKE_FAILED', [6, 7], [1995631, 2150581]], ['HANDSHAKE_FAILED', [8, 9], [2665636, 2826422]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15050462]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15064024]]], [['HANDSHAKE_FAILED', [0, 1], [0, 160392]], ['HANDSHAKE_FAILED', [2, 3], [683514, 840650]], ['HANDSHAKE_FAILED', [4, 5], [1340846, 1496276]], ['HANDSHAKE_FAILED', [6, 7], [1996313, 2152217]], ['HANDSHAKE_FAILED', [8, 9], [2652716, 2808643]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158521]], ['HANDSHAKE_FAILED', [2, 3], [670301, 828379]], ['HANDSHAKE_FAILED', [4, 5], [1341826, 1501330]], ['HANDSHAKE_FAILED', [6, 7], [2003642, 2161708]], ['HANDSHAKE_FAILED', [8, 9], [2669870, 2827878]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156287]], ['HANDSHAKE_FAILED', [2, 3], [662755, 818348]], ['HANDSHAKE_FAILED', [4, 5], [1319160, 1478678]], ['HANDSHAKE_FAILED', [6, 7], [1990920, 2146139]], ['HANDSHAKE_FAILED', [8, 9], [2651604, 2807104]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154578]], ['HANDSHAKE_FAILED', [2, 3], [655735, 810930]], ['HANDSHAKE_FAILED', [4, 5], [1315645, 1471144]], ['HANDSHAKE_FAILED', [6, 7], [1983643, 2138493]], ['HANDSHAKE_FAILED', [8, 9], [2656207, 2811506]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155805]], ['HANDSHAKE_FAILED', [2, 3], [668693, 823264]], ['HANDSHAKE_FAILED', [4, 5], [1347144, 1502679]], ['HANDSHAKE_FAILED', [6, 7], [2017731, 2172841]], ['HANDSHAKE_FAILED', [8, 9], [2700900, 2855535]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156448]], ['HANDSHAKE_FAILED', [2, 3], [689012, 843958]], ['HANDSHAKE_FAILED', [4, 5], [1359595, 1516464]], ['HANDSHAKE_FAILED', [6, 7], [2042873, 2198716]], ['HANDSHAKE_FAILED', [8, 9], [2714307, 2869497]]], [['HANDSHAKE_FAILED', [0, 1], [0, 159492]], ['HANDSHAKE_FAILED', [2, 3], [686213, 840901]], ['HANDSHAKE_FAILED', [4, 5], [1346907, 1501935]], ['HANDSHAKE_FAILED', [6, 7], [2017398, 2173009]], ['HANDSHAKE_FAILED', [8, 9], [2689424, 2844192]]], [['HANDSHAKE_FAILED', [0, 1], [0, 158277]], ['HANDSHAKE_FAILED', [2, 3], [658717, 817515]], ['HANDSHAKE_FAILED', [4, 5], [1329831, 1487230]], ['HANDSHAKE_FAILED', [6, 7], [2002151, 2160207]], ['HANDSHAKE_FAILED', [8, 9], [2681118, 2842925]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15039361]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155550]], ['HANDSHAKE_FAILED', [2, 3], [664726, 820129]], ['HANDSHAKE_FAILED', [4, 5], [1321657, 1477336]], ['HANDSHAKE_FAILED', [6, 7], [1992608, 2147779]], ['HANDSHAKE_FAILED', [8, 9], [2648055, 2804894]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155207]], ['HANDSHAKE_FAILED', [2, 3], [660488, 816547]], ['HANDSHAKE_FAILED', [4, 5], [1341299, 1496587]], ['HANDSHAKE_FAILED', [6, 7], [1997630, 2154183]], ['HANDSHAKE_FAILED', [8, 9], [2654041, 2809800]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15030635]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154822]], ['HANDSHAKE_FAILED', [2, 3], [665637, 820328]], ['HANDSHAKE_FAILED', [4, 5], [1343138, 1499584]], ['HANDSHAKE_FAILED', [6, 7], [2018445, 2173510]], ['HANDSHAKE_FAILED', [8, 9], [2686631, 2842274]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155345]], ['HANDSHAKE_FAILED', [2, 3], [669736, 824290]], ['HANDSHAKE_FAILED', [4, 5], [1327148, 1481993]], ['HANDSHAKE_FAILED', [6, 7], [1982640, 2138740]], ['HANDSHAKE_FAILED', [8, 9], [2650806, 2806388]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155602]], ['HANDSHAKE_FAILED', [2, 3], [671068, 826298]], ['HANDSHAKE_FAILED', [4, 5], [1332378, 1488691]], ['HANDSHAKE_FAILED', [6, 7], [1998554, 2154663]], ['HANDSHAKE_FAILED', [8, 9], [2670087, 2825659]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154425]], ['HANDSHAKE_FAILED', [2, 3], [657589, 815752]], ['HANDSHAKE_FAILED', [4, 5], [1342869, 1498498]], ['HANDSHAKE_FAILED', [6, 7], [1998701, 2154229]], ['HANDSHAKE_FAILED', [8, 9], [2670922, 2826957]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155131]], ['HANDSHAKE_FAILED', [2, 3], [668483, 824880]], ['HANDSHAKE_FAILED', [4, 5], [1336690, 1494006]], ['HANDSHAKE_FAILED', [6, 7], [2008675, 2164547]], ['HANDSHAKE_FAILED', [8, 9], [2682223, 2836925]]], [['HANDSHAKE_FAILED', [0, 1], [0, 157221]], ['HANDSHAKE_FAILED', [2, 3], [667409, 823101]], ['HANDSHAKE_FAILED', [4, 5], [1339318, 1495246]], ['HANDSHAKE_FAILED', [6, 7], [2012862, 2168122]], ['HANDSHAKE_FAILED', [8, 9], [2682401, 2840006]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156067]], ['HANDSHAKE_FAILED', [2, 3], [668603, 824711]], ['HANDSHAKE_FAILED', [4, 5], [1350432, 1506065]], ['HANDSHAKE_FAILED', [6, 7], [2013704, 2169436]], ['HANDSHAKE_FAILED', [8, 9], [2684738, 2839478]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15060636]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154741]], ['HANDSHAKE_FAILED', [2, 3], [680800, 836182]], ['HANDSHAKE_FAILED', [4, 5], [1344069, 1499608]], ['HANDSHAKE_FAILED', [6, 7], [2015105, 2170825]], ['HANDSHAKE_FAILED', [8, 9], [2686661, 2842227]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155705]], ['HANDSHAKE_FAILED', [2, 3], [671360, 833395]], ['HANDSHAKE_FAILED', [4, 5], [1341357, 1497153]], ['HANDSHAKE_FAILED', [6, 7], [1998401, 2153221]], ['HANDSHAKE_FAILED', [8, 9], [2661119, 2816896]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155335]], ['HANDSHAKE_FAILED', [2, 3], [670221, 826805]], ['HANDSHAKE_FAILED', [4, 5], [1342824, 1499021]], ['HANDSHAKE_FAILED', [6, 7], [2014304, 2169511]], ['HANDSHAKE_FAILED', [8, 9], [2669675, 2825634]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15048473]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156518]], ['HANDSHAKE_FAILED', [2, 3], [671325, 827412]], ['HANDSHAKE_FAILED', [4, 5], [1342900, 1500007]], ['HANDSHAKE_FAILED', [6, 7], [2002922, 2158348]], ['HANDSHAKE_FAILED', [8, 9], [2670859, 2827768]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155028]], ['HANDSHAKE_FAILED', [2, 3], [669182, 823840]], ['HANDSHAKE_FAILED', [4, 5], [1331904, 1488374]], ['HANDSHAKE_FAILED', [6, 7], [1996305, 2152561]], ['HANDSHAKE_FAILED', [8, 9], [2653011, 2808519]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15043223]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154968]], ['HANDSHAKE_FAILED', [2, 3], [670708, 827840]], ['HANDSHAKE_FAILED', [4, 5], [1342679, 1498067]], ['HANDSHAKE_FAILED', [6, 7], [1998660, 2154109]], ['HANDSHAKE_FAILED', [8, 9], [2655560, 2811579]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154775]], ['HANDSHAKE_FAILED', [2, 3], [670934, 826005]], ['HANDSHAKE_FAILED', [4, 5], [1343381, 1498813]], ['HANDSHAKE_FAILED', [6, 7], [2018428, 2174416]], ['HANDSHAKE_FAILED', [8, 9], [2690367, 2845421]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154052]], ['HANDSHAKE_FAILED', [2, 3], [671476, 826652]], ['HANDSHAKE_FAILED', [4, 5], [1346390, 1502857]], ['HANDSHAKE_FAILED', [6, 7], [2018465, 2174260]], ['HANDSHAKE_FAILED', [8, 9], [2686636, 2842256]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15038918]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155549]], ['HANDSHAKE_FAILED', [2, 3], [663456, 818605]], ['HANDSHAKE_FAILED', [4, 5], [1327636, 1483204]], ['HANDSHAKE_FAILED', [6, 7], [1983849, 2138847]], ['HANDSHAKE_FAILED', [8, 9], [2639622, 2795435]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15045379]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154663]], ['HANDSHAKE_FAILED', [2, 3], [655545, 811406]], ['HANDSHAKE_FAILED', [4, 5], [1326051, 1481743]], ['HANDSHAKE_FAILED', [6, 7], [1997663, 2154232]], ['HANDSHAKE_FAILED', [8, 9], [2673056, 2831719]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156268]], ['HANDSHAKE_FAILED', [2, 3], [659538, 816946]], ['HANDSHAKE_FAILED', [4, 5], [1318740, 1473817]], ['HANDSHAKE_FAILED', [6, 7], [1986782, 2142725]], ['HANDSHAKE_FAILED', [8, 9], [2643793, 2799238]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155830]], ['HANDSHAKE_FAILED', [2, 3], [671556, 826755]], ['HANDSHAKE_FAILED', [4, 5], [1342944, 1499850]], ['HANDSHAKE_FAILED', [6, 7], [2015341, 2170830]], ['HANDSHAKE_FAILED', [8, 9], [2693244, 2849324]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154222]], ['HANDSHAKE_FAILED', [2, 3], [670457, 827317]], ['HANDSHAKE_FAILED', [4, 5], [1342857, 1499813]], ['HANDSHAKE_FAILED', [6, 7], [2020757, 2176341]], ['HANDSHAKE_FAILED', [8, 9], [2686609, 2841553]]], [['HANDSHAKE_FAILED', [0, 4], [0, 15049531]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156388]], ['HANDSHAKE_FAILED', [2, 3], [668690, 823767]], ['HANDSHAKE_FAILED', [4, 5], [1325131, 1482037]], ['HANDSHAKE_FAILED', [6, 7], [1987403, 2142855]], ['HANDSHAKE_FAILED', [8, 9], [2661461, 2816762]]], [['HANDSHAKE_FAILED', [0, 1], [0, 156027]], ['HANDSHAKE_FAILED', [2, 3], [669978, 829567]], ['HANDSHAKE_FAILED', [4, 5], [1342527, 1497658]], ['HANDSHAKE_FAILED', [6, 7], [2007237, 2162298]], ['HANDSHAKE_FAILED', [8, 9], [2662713, 2818418]]], [['HANDSHAKE_FAILED', [0, 3], [0, 7014909]]], [['HANDSHAKE_FAILED', [0, 1], [0, 154485]], ['HANDSHAKE_FAILED', [2, 3], [666709, 822066]], ['HANDSHAKE_FAILED', [4, 5], [1338782, 1494255]], ['HANDSHAKE_FAILED', [6, 7], [1995591, 2151522]], ['HANDSHAKE_FAILED', [8, 9], [2667161, 2823360]]], [['HANDSHAKE_FAILED', [0, 3], [0, 7026535]]], [['HANDSHAKE_FAILED', [0, 3], [0, 7032582]]], [['HANDSHAKE_FAILED', [0, 1], [0, 155973]], ['HANDSHAKE_FAILED', [2, 3], [655975, 813289]], ['HANDSHAKE_FAILED', [4, 5], [1327657, 1483215]], ['HANDSHAKE_FAILED', [6, 7], [1986383, 2142468]], ['HANDSHAKE_FAILED', [8, 9], [2673093, 2830470]]], [['HANDSHAKE_FAILED', [0, 3], [0, 7029596]]], [['HANDSHAKE_FAILED', [0, 3], [0, 7014131]]], [['HANDSHAKE_FAILED', [0, 2], [0, 3031198]]], [['HANDSHAKE_FAILED', [0, 2], [0, 3034088]]], [['HANDSHAKE', [0, 2], [0, 189701]], ['TLS_handshake', [3, 5], [190042, 380645]], ['OUT_TLS', [6, 9], [382003, 573422], 639]], [['HANDSHAKE_FAILED', [0, 2], [0, 3007820]]], [['HANDSHAKE_FAILED', [0, 2], [0, 3027273]]], [['HANDSHAKE_FAILED', [0, 1], [0, 1014230]]], [['HANDSHAKE_FAILED', [0, 1], [0, 1007791]]]]

def segmented_to_char(segmented_list):
        
    type_to_char_dict = {}
    current_letter = iter(string.ascii_lowercase)
    list_of_str = []
    for flow in segmented_list:
        str_from_seq = ""
        for sequence in flow:
            seq_type = sequence[0]
            if seq_type in type_to_char_dict:
                str_from_seq += type_to_char_dict[seq_type]
            else:
                letter = next(current_letter)
                type_to_char_dict[seq_type] = letter
                str_from_seq += letter
                
        list_of_str.append(str_from_seq)

    return list_of_str, type_to_char_dict


def custom_dist(a,b):
    return a!=b

def distance(a, b):
    l1, l2 = len(a), len(b)
    a = [ord(i) for i in a]
    b = [ord(i) for i in b]

    dtw_distance, _ = fastdtw(list(a), list(b), dist=custom_dist)
    sim = (max(l1, l2) - dtw_distance) / max(l1, l2)
    return sim

def build_similarity_matrix(X):
    X = np.array(X)
    n = X.shape[0]
    similarities = np.zeros((n, n))
    for i in range(n):
        for j in range(i):
            similarities[i][j] = distance(X[i], X[j])
    return similarities + similarities.T - np.diag(similarities.diagonal())

#Different types of clustering
#Spectral clustering - Hierarchical

#Spectral
def build_laplacian(W, laplacian_normalization='unn'):
    """
    Compute graph Laplacian.

    Parameters
    ----------
    W : numpy array
        Adjacency matrix (n x n)
    laplacian_normalization : str
        String selecting which version of the laplacian matrix to construct.
            'unn':  unnormalized,
            'sym': symmetric normalization
            'rw':  random-walk normalization   

    Returns
    -------
    L: (n x n) dimensional matrix representing the Laplacian of the graph
    """
    L = np.zeros(W.shape)
    n = W.shape[0]
    D = np.diag( np.sum( W , axis = 1 ) ) 
    if laplacian_normalization == 'sym':
        L = np.identity(n) - 1/np.sqrt(D) @ W @ 1/np.sqrt(D)
    if laplacian_normalization == 'rw':
        L = np.identity(n) - (1/D) @ W
    else : 
        L = D - W
    return L

def spectral_clustering(L, chosen_eig_indices=None, num_classes=2):
    """
    Parameters
    ----------
    L : numpy array
        Graph Laplacian (standard or normalized)
    choosen_eig_indices : list or None
        Indices of eigenvectors to use for clustering. 
        If None, use adaptive choice of eigenvectors.
    num_classes : int 
        Number of clusters to compute (defaults to 2)


    Returns
    -------
    Y : numpy array (num_samples, )
        Cluster assignments
    """

    """
    Use the function scipy.linalg.eig or the function scipy.sparse.linalg.eigs to compute:
    U = (n x n) eigenvector matrix           (sorted)
    E = (n x n) eigenvalue diagonal matrix   (sorted)
    """
    E , U = scipy.linalg.eig(L)
    U = U.real
    U = U[:,E.argsort()]
    """
    compute the clustering assignment from the eigenvectors        
    Y = (n x 1) cluster assignments in [0,1,...,num_classes-1]                   
    """
    if DEBUG:
        k_choices = range(2, 10)
        Sum_of_squared_distances = []
        for k in k_choices:
            kmeans = KMeans(n_clusters = k)
            kmeans.fit(U[:,chosen_eig_indices])
            Y = kmeans.predict(U[:,chosen_eig_indices])
            Sum_of_squared_distances.append(kmeans.inertia_)
        plt.plot(k_choices, Sum_of_squared_distances, 'bx-')
        plt.xlabel('k')
        plt.ylabel('Sum_of_squared_distances')
        plt.title('Elbow Method For Optimal k')
        plt.show()
    else:
        kmeans = KMeans(n_clusters = num_classes)
        kmeans.fit(U[:,chosen_eig_indices])
        Y = kmeans.predict(U[:,chosen_eig_indices])
    return Y

if __name__ == "__main__":
    stringlify_segmentation, _ = segmented_to_char(test2)
    sim_matrix = build_similarity_matrix(stringlify_segmentation)

    plt.imshow(sim_matrix, interpolation='nearest')
    plt.show()

    num_classes = 3
    L = build_laplacian(sim_matrix)
    Y_rec = spectral_clustering(L, chosen_eig_indices=[1], num_classes=num_classes)

    # Plot results, comparing to KMeans
    print(Y_rec)
